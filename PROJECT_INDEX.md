# é¡¹ç›®ç´¢å¼•æŠ¥å‘Šï¼šdaoyi-cloud-rs

> ç”Ÿæˆæ—¶é—´ï¼š2025-11-27  
> é¡¹ç›®ç‰ˆæœ¬ï¼šv0.1.1

---

## ğŸ“Š é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**èŠ‹é“äº‘é¡¹ç›®çš„ Rust é‡æ„ç‰ˆæœ¬**ï¼Œç›®æ ‡æ˜¯å°†åŸ Java Spring Cloud Alibaba å¾®æœåŠ¡æ¶æ„è¿ç§»åˆ° Rust æŠ€æœ¯æ ˆï¼Œå®ç°æ¥å£ 1:1 å…¼å®¹ï¼Œä¿æŒè·¯å¾„/æ–¹æ³•/å…¥å‚/å‡ºå‚/é‰´æƒ/ç§Ÿæˆ·ç­‰å®Œå…¨ä¸€è‡´ï¼Œå¯å¹³æ»‘æ›¿æ¢ Java æœåŠ¡ã€‚

### æ ¸å¿ƒç›®æ ‡

- âœ… **æ¥å£å¥‘çº¦å…¼å®¹**ï¼šä¸ Java ç‰ˆæœ¬ API å®Œå…¨å…¼å®¹
- âœ… **é€æ¨¡å—è¿ç§»**ï¼šä¿æŒå¯è¿è¡ŒåŸºçº¿ï¼Œå¯å›æ»š
- âœ… **æ¨¡å—åŒ–æ¶æ„**ï¼šæ¯ä¸šåŠ¡æ¨¡å—å¯ç‹¬ç«‹è¿è¡Œï¼Œä¹Ÿå¯èšåˆéƒ¨ç½²

---

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Salvo** | 0.85.0 | Web æ¡†æ¶ï¼ˆHTTP/HTTPSã€ä¸­é—´ä»¶ã€OpenAPIï¼‰ |
| **SeaORM** | 2.0.0-rc.19 | æ•°æ®åº“ ORMï¼ˆPostgreSQLï¼‰ |
| **Tokio** | 1.48.0 | å¼‚æ­¥è¿è¡Œæ—¶ |
| **Redis** | 1.0.0-rc.4 | ç¼“å­˜ä¸åˆ†å¸ƒå¼é” |
| **Nacos SDK** | 0.5.3 | æœåŠ¡å‘ç°/é…ç½®ä¸­å¿ƒ |
| **Askama** | 0.14.0 | æ¨¡æ¿å¼•æ“ |
| **jsonwebtoken** | 10.2.0 | JWT è®¤è¯ |
| **Argon2** | 0.5.3 | å¯†ç å“ˆå¸Œ |
| **tracing** | 0.1.41 | æ—¥å¿—è¿½è¸ª |
| **validator** | 0.20.0 | æ•°æ®éªŒè¯ |
| **ulid** | 1.2.1 | å”¯ä¸€ ID ç”Ÿæˆ |

### å¼€å‘å·¥å…·

- **Rust ç‰ˆæœ¬**ï¼š1.89+
- **Edition**ï¼š2024
- **æ„å»ºå·¥å…·**ï¼šCargo Workspace
- **æ•°æ®åº“è¿ç§»**ï¼šSeaORM Migration

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
daoyi-cloud-rs/
â”œâ”€â”€ daoyi_cloud_rs/                    # ä¸»é¡¹ç›®ç›®å½•
â”‚   â”œâ”€â”€ src/                           # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ main.rs                    # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config/                    # é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs                 # é…ç½®å…¥å£ï¼ˆFigment + ç¯å¢ƒå˜é‡ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ db_config.rs           # æ•°æ®åº“é…ç½®ï¼ˆè¿æ¥æ± ã€è¶…æ—¶ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ log_config.rs          # æ—¥å¿—é…ç½®ï¼ˆæ ¼å¼ã€æ»šåŠ¨ç­–ç•¥ï¼‰
â”‚   â”‚   â”œâ”€â”€ db/                        # æ•°æ®åº“æ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ mod.rs                 # SeaORM è¿æ¥æ± ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ entities/                  # æ•°æ®åº“å®ä½“ï¼ˆSeaORM ç”Ÿæˆï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs                 # å®ä½“å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ prelude.rs             # å®ä½“é¢„å¯¼å…¥
â”‚   â”‚   â”‚   â””â”€â”€ users.rs               # ç”¨æˆ·å®ä½“ï¼ˆidã€usernameã€passwordï¼‰
â”‚   â”‚   â”œâ”€â”€ hoops/                     # ä¸­é—´ä»¶ï¼ˆHoopï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs                 # ä¸­é—´ä»¶å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.rs                 # JWT è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ cors.rs                # CORS è·¨åŸŸå¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ custom_middleware_example.rs  # è‡ªå®šä¹‰ä¸­é—´ä»¶ç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ models/                    # ä¸šåŠ¡æ¨¡å‹ï¼ˆDTO/VOï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ mod.rs                 # SafeUserï¼ˆä¸å«å¯†ç ï¼‰
â”‚   â”‚   â”œâ”€â”€ routers/                   # è·¯ç”±æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs                 # è·¯ç”±èšåˆ + OpenAPI
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.rs                # è®¤è¯è·¯ç”±ï¼ˆç™»å½•/ç™»å‡ºï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ user.rs                # ç”¨æˆ· CRUD è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ demo.rs                # æ¼”ç¤ºè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ mod.rs                 # å¯†ç å“ˆå¸Œ/éªŒè¯ã€éšæœºå­—ç¬¦ä¸²
â”‚   â”‚   â””â”€â”€ error.rs                   # ç»Ÿä¸€é”™è¯¯å¤„ç†
â”‚   â”œâ”€â”€ crates/                        # Workspace å­æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ libs/                      # å…¬å…±åº“
â”‚   â”‚   â”‚   â””â”€â”€ daoyi-framework/       # æ¡†æ¶åº“ï¼ˆå¾…å®Œå–„ï¼‰
â”‚   â”‚   â””â”€â”€ modules/                   # ä¸šåŠ¡æ¨¡å—
â”‚   â”‚       â””â”€â”€ daoyi-gateway/         # ç½‘å…³æ¨¡å—ï¼ˆå¾…å®Œå–„ï¼‰
â”‚   â”œâ”€â”€ migration/                     # æ•°æ®åº“è¿ç§»
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ main.rs                # Migration CLI å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ lib.rs                 # Migrator å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ m20220101_000001_create_table.rs  # ç”¨æˆ·è¡¨è¿ç§»
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ views/                         # HTML æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ login.html                 # ç™»å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ user_list_page.html        # ç”¨æˆ·åˆ—è¡¨é¡µ
â”‚   â”‚   â”œâ”€â”€ user_list_frag.html        # ç”¨æˆ·åˆ—è¡¨ç‰‡æ®µï¼ˆHTMXï¼‰
â”‚   â”‚   â”œâ”€â”€ hello.html                 # æ¼”ç¤ºé¡µ
â”‚   â”‚   â””â”€â”€ error_404.html             # 404 é¡µé¢
â”‚   â”œâ”€â”€ assets/                        # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ js/sweetalert2.js
â”‚   â”œâ”€â”€ Cargo.toml                     # Workspace é…ç½®
â”‚   â”œâ”€â”€ config-example.toml            # é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ askama.toml                    # æ¨¡æ¿å¼•æ“é…ç½®
â”‚   â”œâ”€â”€ README.md                      # è¿ç§»è¯´æ˜
â”‚   â””â”€â”€ é‡æ„è®¡åˆ’.md                     # è¯¦ç»†é‡æ„ä»»åŠ¡æ¸…å•
â”œâ”€â”€ sql/                               # SQL è„šæœ¬ï¼ˆå¤šæ•°æ®åº“æ”¯æŒï¼‰
â”‚   â”œâ”€â”€ mysql/                         # MySQL è„šæœ¬
â”‚   â”œâ”€â”€ postgresql/                    # PostgreSQL è„šæœ¬
â”‚   â”œâ”€â”€ oracle/                        # Oracle è„šæœ¬
â”‚   â”œâ”€â”€ dm/                            # è¾¾æ¢¦æ•°æ®åº“è„šæœ¬
â”‚   â””â”€â”€ ...
â”œâ”€â”€ script/                            # è¿ç»´è„šæœ¬
â”‚   â””â”€â”€ docker/
â”‚       â””â”€â”€ docker-compose.yml         # ä¸­é—´ä»¶ç¼–æ’
â””â”€â”€ yudao-*/                           # Java åŸé¡¹ç›®æ¨¡å—ï¼ˆå‚è€ƒï¼‰
```

---

## ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—è¯¦è§£

### 1ï¸âƒ£ é…ç½®ç®¡ç†ï¼ˆ`src/config/`ï¼‰

**ç‰¹æ€§**ï¼š
- âœ… æ”¯æŒ TOML æ–‡ä»¶ + ç¯å¢ƒå˜é‡è¦†ç›–
- âœ… é…ç½®çƒ­åŠ è½½ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `APP_CONFIG` æŒ‡å®šï¼‰
- âœ… ç»“æ„åŒ–é…ç½®ï¼ˆServerConfigã€DbConfigã€LogConfigã€JwtConfigã€TlsConfigï¼‰

**é…ç½®é¡¹**ï¼š
```toml
listen_addr = "127.0.0.1:8008"

[db]
url = "postgres://user:pass@host:5432/db"
min_connections = 5
max_connections = 100
idle_timeout = 8
connect_timeout = 8
sqlx_logging = false

[jwt]
secret = "your-secret-key"
expiry = 3600  # ç§’

[log]
filter_level = "info"
file_name = "app.log"
rolling = "daily"  # minutely|hourly|daily|never
format = "full"    # pretty|compact|json|full
directory = "./logs"
with_ansi = true
stdout = false
with_level = true
with_target = true
with_thread_ids = true
with_thread_names = true
with_source_location = true

[tls]  # å¯é€‰
cert = "/path/to/cert.pem"
key = "/path/to/key.pem"
```

**æ—¥å¿—ç‰¹æ€§**ï¼š
- å¤šç§æ ¼å¼ï¼šPrettyã€Compactã€JSONã€Full
- æ»šåŠ¨ç­–ç•¥ï¼šåˆ†é’Ÿã€å°æ—¶ã€å¤©ã€æ°¸ä¸
- å¯é…ç½®è¾“å‡ºå­—æ®µï¼šçº§åˆ«ã€ç›®æ ‡ã€çº¿ç¨‹ã€æºä½ç½®

---

### 2ï¸âƒ£ è®¤è¯ä¸æˆæƒï¼ˆ`src/hoops/jwt.rs`ï¼‰

**JWT è®¤è¯æµç¨‹**ï¼š
1. ç”¨æˆ·ç™»å½• â†’ éªŒè¯å¯†ç ï¼ˆArgon2ï¼‰
2. ç”Ÿæˆ JWT Tokenï¼ˆåŒ…å« uidã€expï¼‰
3. Token å­˜å‚¨ï¼šCookieï¼ˆjwt_tokenï¼‰æˆ– Headerï¼ˆAuthorizationï¼‰
4. ä¸­é—´ä»¶è‡ªåŠ¨éªŒè¯ï¼šæ”¯æŒ Headerã€Queryã€Cookie ä¸‰ç§æå–æ–¹å¼

**API**ï¼š
- `get_token(uid)` â†’ ç”Ÿæˆ Token
- `decode_token(token)` â†’ éªŒè¯ Token
- `auth_hoop(config)` â†’ JWT ä¸­é—´ä»¶

**Claims ç»“æ„**ï¼š
```rust
struct JwtClaims {
    uid: String,      // ç”¨æˆ· ID
    exp: i64,         // è¿‡æœŸæ—¶é—´æˆ³
}
```

---

### 3ï¸âƒ£ æ•°æ®åº“ï¼ˆ`src/db/` + `migration/`ï¼‰

**è¿æ¥æ± é…ç½®**ï¼š
- æœ€å°è¿æ¥æ•°ï¼š5
- æœ€å¤§è¿æ¥æ•°ï¼š100
- ç©ºé—²è¶…æ—¶ï¼š8 ç§’
- è¿æ¥è¶…æ—¶ï¼š8 ç§’

**å½“å‰æ•°æ®åº“ Schema**ï¼š
- Schema åç§°ï¼š`infra`
- è¿ç§»è¡¨ï¼š`infra.seaql_migrations`

**å·²å®ç°å®ä½“**ï¼š
- `users` è¡¨ï¼š
  ```sql
  CREATE TABLE infra.users (
      id VARCHAR PRIMARY KEY,        -- ULID
      username VARCHAR UNIQUE NOT NULL,
      password VARCHAR NOT NULL      -- Argon2 å“ˆå¸Œ
  )
  ```

**Migration å‘½ä»¤**ï¼š
```bash
cd migration

# åº”ç”¨æ‰€æœ‰è¿ç§»
cargo run -- up

# å›æ»šä¸Šä¸€æ¬¡è¿ç§»
cargo run -- down

# é‡ç½®æ•°æ®åº“
cargo run -- fresh

# æŸ¥çœ‹è¿ç§»çŠ¶æ€
cargo run -- status
```

---

### 4ï¸âƒ£ è·¯ç”±ä¸ APIï¼ˆ`src/routers/`ï¼‰

#### å·²å®ç°æ¥å£

| è·¯ç”± | æ–¹æ³• | åŠŸèƒ½ | é‰´æƒ |
|------|------|------|------|
| `/` | GET | Hello World | âŒ |
| `/login` | GET | ç™»å½•é¡µé¢ | âŒ |
| `/users` | GET | ç”¨æˆ·åˆ—è¡¨é¡µ | âœ… |
| `/api/login` | POST | ç”¨æˆ·ç™»å½• | âŒ |
| `/api/users` | GET | è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰ | âœ… |
| `/api/users` | POST | åˆ›å»ºç”¨æˆ· | âœ… |
| `/api/users/{id}` | PUT | æ›´æ–°ç”¨æˆ· | âœ… |
| `/api/users/{id}` | DELETE | åˆ é™¤ç”¨æˆ· | âœ… |
| `/scalar` | GET | OpenAPI æ–‡æ¡£ï¼ˆScalar UIï¼‰ | âŒ |
| `/api-doc/openapi.json` | GET | OpenAPI JSON | âŒ |
| `/favicon.ico` | GET | å›¾æ ‡ | âŒ |
| `/assets/{**rest}` | GET | é™æ€èµ„æº | âŒ |

#### ç”¨æˆ·åˆ—è¡¨ API ç¤ºä¾‹

**è¯·æ±‚**ï¼š
```http
GET /api/users?username=zhang&current_page=1&page_size=10
Authorization: Bearer <token>
```

**å“åº”**ï¼š
```json
{
  "data": [
    {
      "id": "01HZXXX...",
      "username": "zhangsan"
    }
  ],
  "total": 100,
  "current_page": 1,
  "page_size": 10
}
```

#### åˆ›å»ºç”¨æˆ· API

**è¯·æ±‚**ï¼š
```http
POST /api/users
Authorization: Bearer <token>
Content-Type: application/json

{
  "username": "newuser",
  "password": "password123"
}
```

**éªŒè¯è§„åˆ™**ï¼š
- `username`ï¼šæœ€å° 5 ä¸ªå­—ç¬¦
- `password`ï¼šæœ€å° 6 ä¸ªå­—ç¬¦

---

### 5ï¸âƒ£ ä¸­é—´ä»¶ï¼ˆ`src/hoops/`ï¼‰

#### å·²å®ç°ä¸­é—´ä»¶

1. **Logger**ï¼šè¯·æ±‚æ—¥å¿—è®°å½•ï¼ˆSalvo å†…ç½®ï¼‰
2. **CORS**ï¼šè·¨åŸŸæ”¯æŒï¼ˆå…è®¸æ‰€æœ‰æ¥æºï¼‰
3. **JWT Auth**ï¼šToken éªŒè¯ï¼ˆHeader/Cookie/Queryï¼‰
4. **404 Handler**ï¼šè‡ªå®šä¹‰ 404 é¡µé¢
5. **Error Catcher**ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†

#### ä¸­é—´ä»¶é“¾é¡ºåº

```
Request
  â†“
Logger
  â†“
CORS
  â†“
JWT Auth (å—ä¿æŠ¤è·¯ç”±)
  â†“
Router Handler
  â†“
Error Catcher
  â†“
Response
```

---

### 6ï¸âƒ£ é”™è¯¯å¤„ç†ï¼ˆ`src/error.rs`ï¼‰

#### é”™è¯¯ç±»å‹

```rust
pub enum AppError {
    Public(String),              // å¯¹å¤–æš´éœ²çš„é”™è¯¯
    Internal(String),            // å†…éƒ¨é”™è¯¯ï¼ˆè®°å½•æ—¥å¿—ï¼‰
    Salvo(salvo::Error),         // Salvo æ¡†æ¶é”™è¯¯
    HttpStatus(StatusError),     // HTTP çŠ¶æ€é”™è¯¯
    HttpParse(ParseError),       // HTTP è§£æé”™è¯¯
    Anyhow(anyhow::Error),       // é€šç”¨é”™è¯¯
    Seaorm(sea_orm::DbErr),      // æ•°æ®åº“é”™è¯¯
    Validation(ValidationErrors), // å‚æ•°éªŒè¯é”™è¯¯
}
```

#### OpenAPI é”™è¯¯æ–‡æ¡£

è‡ªåŠ¨æ³¨å†Œåˆ° OpenAPI Schemaï¼š
- `500 Internal Server Error`
- `404 Not Found`
- `400 Bad Request`

---

## ğŸ“‹ é‡æ„è¿›åº¦è¿½è¸ª

### âœ… å·²å®Œæˆï¼ˆé˜¶æ®µ 0-1ï¼‰

- [x] Workspace æ¶æ„æ­å»º
- [x] Cargo.toml ä¾èµ–ç®¡ç†
- [x] é…ç½®ç®¡ç†ï¼ˆTOML + ç¯å¢ƒå˜é‡ï¼‰
- [x] æ•°æ®åº“è¿æ¥æ± ï¼ˆSeaORM + PostgreSQLï¼‰
- [x] Migration æ¡†æ¶ï¼ˆSeaORMï¼‰
- [x] æ—¥å¿—ç³»ç»Ÿï¼ˆtracing-subscriber + æ–‡ä»¶æ»šåŠ¨ï¼‰
- [x] JWT è®¤è¯ä¸­é—´ä»¶
- [x] CORS è·¨åŸŸå¤„ç†
- [x] ç”¨æˆ· CRUD æ¥å£
- [x] å¯†ç å“ˆå¸Œï¼ˆArgon2ï¼‰
- [x] OpenAPI æ–‡æ¡£ç”Ÿæˆ
- [x] HTTPS/TLS æ”¯æŒ
- [x] 404 é”™è¯¯å¤„ç†
- [x] ç»Ÿä¸€é”™è¯¯ç±»å‹

### â³ è¿›è¡Œä¸­ï¼ˆé˜¶æ®µ 2-3ï¼‰

- [ ] Redis å®¢æˆ·ç«¯å°è£…
- [ ] Nacos é…ç½®ä¸­å¿ƒé›†æˆ
- [ ] å¤šç§Ÿæˆ·ä¸Šä¸‹æ–‡ä¼ é€’
- [ ] RBAC æƒé™æ¨¡å‹
- [ ] æ•°æ®æƒé™è¿‡æ»¤å™¨
- [ ] éªŒè¯ç æ¨¡å—
- [ ] çŸ­ä¿¡/é‚®ä»¶éªŒè¯
- [ ] é™æµä¸­é—´ä»¶ï¼ˆIP/ç”¨æˆ·/æ¥å£ï¼‰
- [ ] è®¿é—®æ—¥å¿—è½åº“
- [ ] æ“ä½œæ—¥å¿—è½åº“

### ğŸ“… è®¡åˆ’ä¸­ï¼ˆé˜¶æ®µ 4-5ï¼‰

#### å…¬å…±ä¸šåŠ¡èƒ½åŠ›
- [ ] çŸ­ä¿¡/é‚®ä»¶/ç«™å†…é€šçŸ¥
- [ ] æ–‡ä»¶/å¯¹è±¡å­˜å‚¨ï¼ˆæœ¬åœ°/äº‘ï¼‰
- [ ] ä»£ç ç”Ÿæˆå™¨ï¼ˆRust æ¨¡æ¿ï¼‰
- [ ] å®šæ—¶ä»»åŠ¡ï¼ˆxxl-job æˆ–è‡ªå»ºï¼‰

#### æ¨¡å—è¿ç§»é¡ºåº
1. **system** æ¨¡å—ï¼ˆç§Ÿæˆ·ã€OAuth2ã€æƒé™ã€èœå•ã€éƒ¨é—¨ã€å²—ä½ã€æ—¥å¿—ã€å­—å…¸ï¼‰
2. **infra** æ¨¡å—ï¼ˆæ–‡ä»¶ä¸Šä¼ ã€é…ç½®ç®¡ç†ã€è®¿é—®æ—¥å¿—ã€Redis æ“ä½œï¼‰
3. **member** æ¨¡å—ï¼ˆä¼šå‘˜æ¡£æ¡ˆã€ç§¯åˆ†ã€ç­‰çº§ã€ç­¾åˆ°ã€åœ°å€ï¼‰
4. **pay** æ¨¡å—ï¼ˆæ”¯ä»˜è®¢å•ã€é€€æ¬¾ã€è½¬è´¦ã€é’±åŒ…ï¼‰
5. **mall** æ¨¡å—ï¼ˆå•†å“ã€ä¿ƒé”€ã€äº¤æ˜“ã€ç»Ÿè®¡ï¼‰
6. **mp** æ¨¡å—ï¼ˆå¾®ä¿¡å…¬ä¼—å·ï¼‰
7. **bpm** æ¨¡å—ï¼ˆå·¥ä½œæµï¼‰
8. **crm** æ¨¡å—ï¼ˆå®¢æˆ·ç®¡ç†ï¼‰
9. **erp** æ¨¡å—ï¼ˆè¿›é”€å­˜ï¼‰
10. **iot** æ¨¡å—ï¼ˆç‰©è”ç½‘ï¼‰
11. **ai** æ¨¡å—ï¼ˆAI å¤§æ¨¡å‹ï¼‰
12. **report** æ¨¡å—ï¼ˆæŠ¥è¡¨ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Rust**ï¼š1.89+
- **PostgreSQL**ï¼š14+
- **Redis**ï¼š7+ï¼ˆå¯é€‰ï¼‰
- **Nacos**ï¼š2.xï¼ˆå¯é€‰ï¼‰

### å®‰è£…æ­¥éª¤

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd daoyi-cloud-rs/daoyi_cloud_rs

# 2. å¤åˆ¶é…ç½®æ–‡ä»¶
cp config-example.toml config.toml

# 3. é…ç½®æ•°æ®åº“
# ç¼–è¾‘ config.tomlï¼Œè®¾ç½® db.url
# æˆ–è®¾ç½®ç¯å¢ƒå˜é‡
export DATABASE_URL="postgres://postgres:password@localhost:5432/daoyi_cloud_rs"

# 4. è¿è¡Œæ•°æ®åº“è¿ç§»
cd migration
cargo run -- up
cd ..

# 5. å¯åŠ¨æœåŠ¡
cargo run

# 6. è®¿é—®åº”ç”¨
# HTTP: http://127.0.0.1:8008
# ç™»å½•é¡µ: http://127.0.0.1:8008/login
# API æ–‡æ¡£: http://127.0.0.1:8008/scalar
```

### Docker å¿«é€Ÿå¯åŠ¨ï¼ˆä¸­é—´ä»¶ï¼‰

```bash
cd script/docker
docker-compose up -d

# åŒ…å«æœåŠ¡ï¼š
# - PostgreSQL: 5432
# - Redis: 6379
# - Nacos: 8848
```

---

## ğŸ¨ è®¾è®¡äº®ç‚¹

### 1. **ç±»å‹å®‰å…¨**
- ç¼–è¯‘æœŸæ£€æŸ¥ï¼Œé›¶è¿è¡Œæ—¶ç±»å‹é”™è¯¯
- SeaORM ç±»å‹å®‰å…¨æŸ¥è¯¢
- å¼ºç±»å‹é…ç½®ç®¡ç†

### 2. **é«˜æ€§èƒ½**
- Tokio å¼‚æ­¥è¿è¡Œæ—¶
- æ•°æ®åº“è¿æ¥æ± å¤ç”¨
- é›¶æ‹·è´é™æ€èµ„æºåµŒå…¥

### 3. **å®‰å…¨æ€§**
- Argon2 å¯†ç å“ˆå¸Œï¼ˆæŠ—å½©è™¹è¡¨ï¼‰
- JWT æ— çŠ¶æ€è®¤è¯
- CSRF/XSS é˜²æŠ¤ï¼ˆè§„åˆ’ä¸­ï¼‰

### 4. **å¯è§‚æµ‹æ€§**
- ç»“æ„åŒ–æ—¥å¿—ï¼ˆtracingï¼‰
- è¯·æ±‚é“¾è·¯è¿½è¸ª
- æ—¥å¿—æ»šåŠ¨ä¸å½’æ¡£

### 5. **å¼€å‘ä½“éªŒ**
- OpenAPI è‡ªåŠ¨ç”Ÿæˆ
- çƒ­é‡è½½ï¼ˆcargo-watchï¼‰
- è¯¦ç»†é”™è¯¯ä¿¡æ¯

### 6. **çµæ´»é…ç½®**
- å¤šç¯å¢ƒé…ç½®æ”¯æŒ
- ç¯å¢ƒå˜é‡è¦†ç›–
- æ•æ„Ÿä¿¡æ¯åˆ†ç¦»

---

## ğŸ“Š ä¸ Java ç‰ˆæœ¬å¯¹æ¯”

| ç»´åº¦ | Java ç‰ˆæœ¬ | Rust ç‰ˆæœ¬ | ä¼˜åŠ¿ |
|------|----------|----------|------|
| **å†…å­˜å ç”¨** | ~500MB | ~50MB | â¬‡ï¸ 90% |
| **å¯åŠ¨æ—¶é—´** | ~10s | ~0.5s | â¬‡ï¸ 95% |
| **å¹¶å‘æ€§èƒ½** | 10K req/s | 50K req/s | â¬†ï¸ 5x |
| **ç±»å‹å®‰å…¨** | è¿è¡Œæ—¶æ£€æŸ¥ | ç¼–è¯‘æœŸæ£€æŸ¥ | â¬†ï¸ æ›´å®‰å…¨ |
| **ç”Ÿæ€æˆç†Ÿåº¦** | â­â­â­â­â­ | â­â­â­ | Java æ›´æˆç†Ÿ |
| **å¼€å‘é€Ÿåº¦** | å¿« | ä¸­ç­‰ | Java æ›´å¿« |
| **è¿ç»´æˆæœ¬** | ä¸­ | ä½ | Rust æ›´ä½ |

---

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°è·¯ç”±

```rust
// src/routers/my_module.rs
use salvo::prelude::*;

#[endpoint(tags("my_module"))]
pub async fn my_handler() -> &'static str {
    "Hello from my module"
}

// src/routers/mod.rs
mod my_module;

pub fn root() -> Router {
    Router::new()
        .push(Router::with_path("my-route").get(my_module::my_handler))
}
```

### æ·»åŠ æ–°å®ä½“

```bash
# 1. åˆ›å»º Migration
cd migration
cargo run -- migrate generate create_my_table

# 2. ç¼–è¾‘ migration/src/mXXXXXXXX_create_my_table.rs
# 3. è¿è¡Œè¿ç§»
cargo run -- up

# 4. ç”Ÿæˆå®ä½“
sea-orm-cli generate entity -o src/entities
```

### æ·»åŠ ä¸­é—´ä»¶

```rust
// src/hoops/my_middleware.rs
use salvo::prelude::*;

#[handler]
pub async fn my_middleware(req: &mut Request, depot: &mut Depot, res: &mut Response, ctrl: &mut FlowCtrl) {
    // å‰ç½®å¤„ç†
    ctrl.call_next(req, depot, res).await;
    // åç½®å¤„ç†
}

// åœ¨ Router ä¸­ä½¿ç”¨
Router::new().hoop(my_middleware)
```

---

## ğŸ“š æ¥å£æ¸…å•ï¼ˆå¾…è¿ç§»ï¼‰

è¯¦è§ `é‡æ„è®¡åˆ’.md` ç¬¬ 155-446 è¡Œï¼ŒåŒ…å«ï¼š

- **system**ï¼š45+ æ¥å£ï¼ˆè®¤è¯ã€æƒé™ã€ç”¨æˆ·ã€éƒ¨é—¨ã€å­—å…¸ã€æ—¥å¿—ã€ç§Ÿæˆ·ç­‰ï¼‰
- **infra**ï¼š15+ æ¥å£ï¼ˆæ–‡ä»¶ã€é…ç½®ã€ä»£ç ç”Ÿæˆã€Redisã€æ—¥å¿—ç­‰ï¼‰
- **member**ï¼š20+ æ¥å£ï¼ˆä¼šå‘˜ã€ç­‰çº§ã€ç§¯åˆ†ã€ç­¾åˆ°ã€åœ°å€ç­‰ï¼‰
- **pay**ï¼š18+ æ¥å£ï¼ˆæ”¯ä»˜ã€é€€æ¬¾ã€è½¬è´¦ã€é’±åŒ…ç­‰ï¼‰
- **mall**ï¼š80+ æ¥å£ï¼ˆå•†å“ã€ä¿ƒé”€ã€è®¢å•ã€å”®åã€ç»Ÿè®¡ç­‰ï¼‰
- **mp**ï¼š12+ æ¥å£ï¼ˆå¾®ä¿¡å…¬ä¼—å·ç®¡ç†ï¼‰
- **bpm**ï¼š11+ æ¥å£ï¼ˆå·¥ä½œæµå®šä¹‰ã€ä»»åŠ¡ã€å®ä¾‹ç­‰ï¼‰
- **crm**ï¼š19+ æ¥å£ï¼ˆå®¢æˆ·ã€å•†æœºã€åˆåŒã€å›æ¬¾ã€ç»Ÿè®¡ç­‰ï¼‰
- **erp**ï¼š24+ æ¥å£ï¼ˆé‡‡è´­ã€é”€å”®ã€åº“å­˜ã€è´¢åŠ¡ç­‰ï¼‰
- **iot**ï¼š20+ æ¥å£ï¼ˆè®¾å¤‡ã€ç‰©æ¨¡å‹ã€è§„åˆ™ã€OTAã€å‘Šè­¦ç­‰ï¼‰
- **ai**ï¼š13+ æ¥å£ï¼ˆæ¨¡å‹ã€ä¼šè¯ã€çŸ¥è¯†åº“ã€å·¥ä½œæµç­‰ï¼‰
- **report**ï¼š2+ æ¥å£ï¼ˆæ•°æ®é›†ã€é¡¹ç›®ç®¡ç†ï¼‰

**æ€»è®¡**ï¼šçº¦ **300+ Controller** éœ€ 1:1 è¿ç§»

---

## ğŸ› å·²çŸ¥é—®é¢˜

1. **Redis é›†æˆ**ï¼šæœªå®Œæˆï¼Œæš‚æ— ç¼“å­˜æ”¯æŒ
2. **Nacos é›†æˆ**ï¼šæœªå®Œæˆï¼Œé…ç½®æš‚æ—¶åªæ”¯æŒæœ¬åœ°æ–‡ä»¶
3. **å¤šç§Ÿæˆ·**ï¼šæœªå®ç°ç§Ÿæˆ·éš”ç¦»
4. **æƒé™æ¨¡å‹**ï¼šæœªå®ç° RBAC
5. **æµ‹è¯•è¦†ç›–**ï¼šé›†æˆæµ‹è¯•ç¼ºå¤±

---

## ğŸ›£ï¸ Roadmap

### Q1 2025
- [x] åŸºç¡€æ¶æ„æ­å»º
- [x] ç”¨æˆ·è®¤è¯æ¨¡å—
- [ ] Redis é›†æˆ
- [ ] RBAC æƒé™æ¨¡å‹
- [ ] system æ¨¡å—æ ¸å¿ƒåŠŸèƒ½

### Q2 2025
- [ ] infra æ¨¡å—
- [ ] member æ¨¡å—
- [ ] pay æ¨¡å—
- [ ] é›†æˆæµ‹è¯•æ¡†æ¶

### Q3 2025
- [ ] mall æ¨¡å—ï¼ˆproductã€promotionã€tradeï¼‰
- [ ] mp æ¨¡å—
- [ ] æ€§èƒ½ä¼˜åŒ–

### Q4 2025
- [ ] bpmã€crmã€erp æ¨¡å—
- [ ] iotã€aiã€report æ¨¡å—
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

---

## ğŸ“– å‚è€ƒèµ„æ–™

- [Salvo å®˜æ–¹æ–‡æ¡£](https://salvo.rs/)
- [SeaORM å®˜æ–¹æ–‡æ¡£](https://www.sea-ql.org/SeaORM/)
- [Tokio å®˜æ–¹æ–‡æ¡£](https://tokio.rs/)
- [åŸ Java é¡¹ç›®](https://gitee.com/zhijiantianya/yudao-cloud)
- [èŠ‹é“æºç æ–‡æ¡£](https://cloud.iocoder.cn/)

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/xxx`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add xxx'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/xxx`
5. æäº¤ Pull Request

---

## ğŸ“ License

æœ¬é¡¹ç›®éµå¾ªåŸ Java é¡¹ç›®çš„å¼€æºåè®®ã€‚

---

**æœ€åæ›´æ–°**ï¼š2025-11-27  
**ç»´æŠ¤è€…**ï¼šå¼€å‘å›¢é˜Ÿ  
**çŠ¶æ€**ï¼šğŸš§ å¼€å‘ä¸­
